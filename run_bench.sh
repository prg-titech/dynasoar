#!/bin/bash
#arr=(4456448 4718592 4980736 5242880 5505024 5767168 6029312 6291456 6553600 6815744 7077888 7340032 7602176 7864320 8126464 8388608 8650752 8912896 9175040 9437184 9699328 9961472 10223616 10485760 10747904 11010048 11272192 11534336 11796480 12058624 12320768 12582912 12845056 13107200 13369344 13631488 13893632 14155776 14417920 14680064 14942208 15204352 15466496 15728640 15990784 16252928 16515072 16777216 33554432 50331648 67108864 83886080 100663296 117440512 134217728 150994944 167772160 184549376 201326592 218103808 234881024 251658240 268435456 285212672 301989888 318767104 335544320 352321536 369098752 385875968 402653184 419430400 436207616 452984832 469762048 486539264 503316480 520093696 536870912 553648128 570425344 587202560 603979776 620756992 637534208 654311424 671088640 687865856 704643072 721420288 738197504 754974720 771751936 788529152 805306368 822083584 838860800 855638016 872415232 889192448 905969664 922746880 939524096 956301312 973078528 989855744 1006632960 1023410176 1040187392 1056964608)
for (( i=17; i<=2048; i++))
do
#for i in "${arr[@]}"
#do
  size=$(($i*262144))
  echo ${size}
  cmake -DCMAKE_BUILD_TYPE=Release -DALLOCATOR=SoaAlloc .
  echo "static const int kNumObj = ${size};" > example/wa-tor/extra_config.h
  make wator_soa_no_cell

  res=`bin/wator_soa_no_cell`
  echo $res >> wator_scale_heap_soa_cub.csv
  cat wator_scale_heap_soa_cub.csv
done

